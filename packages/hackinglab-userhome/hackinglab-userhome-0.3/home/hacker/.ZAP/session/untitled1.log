/*C5*/SET SCHEMA PUBLIC
ALTER TABLE ALERT ADD COLUMN SOURCEHISTORYID INT DEFAULT 0
ALTER TABLE ALERT ADD COLUMN ATTACK VARCHAR(32768) DEFAULT ''
ALTER TABLE ALERT ADD COLUMN EVIDENCE VARCHAR(32768) DEFAULT ''
ALTER TABLE ALERT ADD COLUMN CWEID INT DEFAULT -1
ALTER TABLE ALERT ADD COLUMN WASCID INT DEFAULT -1
/*C7*/SET SCHEMA PUBLIC
CREATE cached TABLE TAG (tagid bigint generated by default as identity (start with 1), historyid bigint not null, tag varchar(1024) default '')
/*C8*/SET SCHEMA PUBLIC
CREATE cached TABLE SESSION_URL (urlid bigint generated by default as identity (start with 1), type int not null, url varchar(8192) default '')
/*C9*/SET SCHEMA PUBLIC
CREATE cached TABLE PARAM (paramid bigint generated by default as identity (start with 1), site varchar(32768) not null, type varchar(32768) not null, name varchar(32768) not null, used int not null, flags varchar(32768) not null, vals varchar(8388608) not null)
/*C10*/SET SCHEMA PUBLIC
CREATE cached TABLE CONTEXT_DATA (dataid bigint generated by default as identity (start with 1), contextId int not null, type int not null, data varchar(8192) default '')
/*C11*/SET SCHEMA PUBLIC
CREATE CACHED TABLE websocket_channel (channel_id BIGINT PRIMARY KEY,host VARCHAR(255) NOT NULL,port INTEGER NOT NULL,url VARCHAR(255) NOT NULL,start_timestamp TIMESTAMP NOT NULL,end_timestamp TIMESTAMP NULL,history_id INTEGER NULL,FOREIGN KEY (history_id) REFERENCES HISTORY(HISTORYID) ON DELETE SET NULL ON UPDATE SET NULL)
CREATE CACHED TABLE websocket_message (message_id BIGINT NOT NULL,channel_id BIGINT NOT NULL,timestamp TIMESTAMP NOT NULL,opcode TINYINT NOT NULL,payload_utf8 CLOB(16M) NULL,payload_bytes BLOB(16M) NULL,payload_length BIGINT NOT NULL,is_outgoing BOOLEAN NOT NULL,PRIMARY KEY (message_id, channel_id),FOREIGN KEY (channel_id) REFERENCES websocket_channel(channel_id))
ALTER TABLE websocket_message ADD CONSTRAINT websocket_message_payload CHECK (payload_utf8 IS NOT NULL OR payload_bytes IS NOT NULL)
CREATE CACHED TABLE websocket_message_fuzz (fuzz_id BIGINT NOT NULL,message_id BIGINT NOT NULL,channel_id BIGINT NOT NULL,state VARCHAR(50) NOT NULL,fuzz LONGVARCHAR NOT NULL,PRIMARY KEY (fuzz_id, message_id, channel_id),FOREIGN KEY (message_id, channel_id) REFERENCES websocket_message(message_id, channel_id) ON DELETE CASCADE)
